<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <title>WebPivotTable Component</title>

  <style type="text/css">
    html, body {width:100%;height:100%; padding:0; margin:0;}
  </style>

  <script type="text/javascript" src="./dist/wpt.js"></script>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>
     $(document).ready(function(){
       var wpt = $('web-pivot-table')[0];
       wpt.setOptions({
         styles: {
           highLightColor: 'rgb(250, 224, 177)',
         },
         uiFlags: {
           report: 0,
         },
         customHandlers: {
           connectSource: 0,
           openWpt: 1,
           saveWpt: 1,
           drillThrough: 1
         },
         filestack: {
           enabled: true,
           key: "A4bieoUsyR4yBrNPkFIvrz"  //demo.webpivottable.com
         },
       });

       wpt.addEventListener(wpt.Constants.eventType.NEW_WPT, function(event) {
         console.log("customize newWpt", event);
       });

       wpt.addEventListener(wpt.Constants.eventType.OPEN_WPT, function(event) {
         console.log("customize open Wpt", event);
       });

       wpt.addEventListener(wpt.Constants.eventType.SAVE_WPT, function(event) {
         console.log("customize saveWpt", event);
       });

       wpt.addEventListener(wpt.Constants.eventType.DRILL_THROUGH, function(event) {
         console.log("customize drillthrough", event);
       });

       // wpt.setWptFromOlapCube({
       //   catalog: "FoodMart",
       //   cubeName: "HR",
       //   dataSourceInfo: "Provider=Mondrian;DataSource=MondrianFoodMart;",
       //   xmlaUrl: "http://52.4.22.157:8080/mondrian/xmla"
       // });

       // wpt.setWptFromDataArray(
       //   ['asd', 'ccc'],
       //   [[1, 2], [3, 4], [5, 6]],
       //   "url"
       // );

       // wpt.setWptFromCsvUrl("https://webpivottable.com/testfiles/example.csv");

       // wpt.setWptFromExcelUrl("https://webpivottable.com/testfiles/example.xls");

       // wpt.setWptFromWptUrl("https://webpivottable.com/testfiles/file631.wpt");

       // wpt.setWptFromWebService('https://demo.webpivottable.com/wpt/wsSample');

       wpt.setWptFromGoogleSpreadSheet("https://docs.google.com/spreadsheet/pub?key=0Alkl5EEsxBwBdDFLV2Q4a1NWMmw1TXZBRlFMZ1Rxd0E&output=html");

       // var obj={"format":"WPT","version":"3.0","pivot":{"fields":{},"rows":[{"id":"H-[Date].[Calendar]","children":[{"id":"L-[Date].[Calendar].[(All)]"},{"id":"L-[Date].[Calendar].[Calendar Year]"},{"id":"L-[Date].[Calendar].[Calendar Semester]"},{"id":"L-[Date].[Calendar].[Calendar Quarter]"},{"id":"L-[Date].[Calendar].[Month]"},{"id":"L-[Date].[Calendar].[Date]"}]}],"columns":[],"filters":[],"values":[{"id":"M-[Measures].[Average Rate]"},{"id":"M-[Measures].[Average Sales Amount]"}],"valuesInAxis":0,"valuesIndex":0,"nonEmpty":1},"collapsed":{},"options":{"showGrid":1,"expandRows":1,"expandCols":1,"showRowTotals":1,"showColTotals":1,"showRowSubtotals":1,"showColSubtotals":1,"grid":{"showSigns":1,"showEmptyAsZero":0,"compactForm":1,"rowHeaderWidth":200,"cellWidth":100,"cellHeight":20,"theme":"wpt-default","noFixedColumns":0,"cellStyle":{"columnHeader":{"textAlign":"center","backgroundColor":"#bfd6eb","fontWeight":"bold"},"compoundColumn":{"verticalAlign":"top","textAlign":"left","backgroundColor":"#bfd6eb","fontWeight":"bold"},"rowHeader":{"textAlign":"left","backgroundColor":"#bfd6eb","fontWeight":"bold"},"compoundRow":{"verticalAlign":"top","textAlign":"left","backgroundColor":"#bfd6eb","fontWeight":"bold"},"totalCell":{"textAlign":"right","backgroundColor":"#72d2df"},"subtotalCell":{"textAlign":"right","backgroundColor":"#d2e9e9"},"dataCell":{"textAlign":"right","backgroundColor":"#eee"},"noDataCell":{"backgroundColor":"#ddd"}}},"chart":{"width":500,"height":300,"combined":true,"high":{"theme":"default","chart":{"type":"column","options3d":{"enabled":false,"alpha":15,"beta":15,"depth":50,"viewDistance":25}},"credits":{"enabled":false},"exporting":{"enabled":false},"navigation":{"buttonOptions":{"align":"right","verticalAlign":"top"}},"legend":{"enabled":true,"floating":false,"layout":"vertical","align":"right","verticalAlign":"middle","reversed":false},"tooltip":{"enabled":true,"shadow":true},"plotOptions":{"series":{"stacking":null,"dataLabels":{"enabled":false,"align":"center","rotation":0}}},"xAxis":{"labels":{"enabled":true,"align":"left","rotation":45}}}}},"source":{"mode":"OLAP","url":"http://olap.flexmonster.com/olap/msmdpump.dll","data":{"xmlaUrl":"http://olap.flexmonster.com/olap/msmdpump.dll","dataSourceInfo":"Provider=Microsoft Analysis Services;DataSource=WIN-IA9HPVD1RU5;","catalog":"Adventure Works DW Standard Edition","cubeName":"Adventure Works"}}}
       //
       // wpt.setWpt(obj).then( function(response){
       //   console.log("setWptObject", response);
       // });


       // wpt.generateWptString(false).then(function(wptString){
       //   console.log("wptString", wptString);
       // });

       // wpt.generateWptJSON(false).then(function(wptObj){
       //   console.log("wptJSON", wptObj);
       // });

       $('#locale-select').on('change', function() {
         var value = this.value;
         if (value) {
           var wpt = $('web-pivot-table')[0];
           wpt.setLocale(value);
         }
       });
     });
  </script>

</head>

<body>
  <div style="padding:10px;">
    <h3 style="text-align: center;margin:0;">Test wpt component</h3>
    <div>
      Switch Locale:
      <select id="locale-select">
        <option value="" selected disabled hidden>Choose here</option>
        <option value="en">English</option>
        <option value="zh-CN">Chinese</option>
        <option value="de">German</option>
        <option value="it">Italian</option>
        <option value="pt">Portuguese</option>
        <option value="es">Spain</option>
        <option value="tr-TR">Turkey</option>
      </select>
    </div>
  </div>

  <div style="width:98%; height:90%; margin: auto;">
    <web-pivot-table
      options='{"localeFilePath": "./lang/", "locale":"en", "leavePageWarning": 0}'>
    </web-pivot-table>
  </div>
</body>

</html>
